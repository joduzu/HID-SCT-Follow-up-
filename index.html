<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HID SCT Self-Assessment Grid - Editable</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0d6efd;
            --secondary: #6c757d;
            --success: #198754;
            --info: #0dcaf0;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #212529;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7f9;
            padding: 20px 0;
        }
        
        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .sidebar {
            background-color: #2c3e50;
            color: white;
            height: 100vh;
            position: sticky;
            top: 0;
            padding-top: 20px;
            overflow-y: auto;
        }
        
        .sidebar .nav-link {
            color: rgba(255, 255, 255, 0.8);
            border-left: 3px solid transparent;
            padding: 10px 15px;
            margin: 5px 0;
            transition: all 0.3s;
        }
        
        .sidebar .nav-link:hover, .sidebar .nav-link.active {
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
            border-left-color: var(--info);
        }
        
        .sidebar .nav-link i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .main-content {
            padding: 20px;
            max-height: 100vh;
            overflow-y: auto;
        }
        
        .progress-sidebar {
            background-color: #f8f9fa;
            height: 100vh;
            position: sticky;
            top: 0;
            padding: 20px 15px;
            overflow-y: auto;
            border-left: 1px solid #e9ecef;
        }
        
        .progress-bar-container {
            background-color: #e9ecef;
            border-radius: 5px;
            margin-bottom: 20px;
            height: 30px;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        .section-card {
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 8px;
        }
        
        .section-header {
            background-color: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            border-radius: 8px 8px 0 0;
        }
        
        .assessment-item {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .assessment-item:last-child {
            border-bottom: none;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .comments-section {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 0 0 8px 8px;
            border-top: 1px solid #e9ecef;
        }
        
        .overview-card {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .overview-card .card-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .score-display {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .assessment-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .assessment-table th, .assessment-table td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }
        
        .assessment-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .score-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .score-0 { background: #fee2e2; color: #dc2626; }
        .score-1 { background: #fed7aa; color: #ea580c; }
        .score-2 { background: #fef3c7; color: #ca8a04; }
        .score-3 { background: #d1fae5; color: #059669; }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        .progress-sidebar-table {
            width: 100%;
            font-size: 0.85rem;
        }
        
        .progress-sidebar-table th, .progress-sidebar-table td {
            padding: 8px 5px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .progress-sidebar-table th {
            font-weight: 600;
        }
        
        .progress-sidebar-table tr:last-child td {
            border-bottom: none;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        .summary-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        @media (max-width: 992px) {
            .progress-sidebar {
                display: none;
            }
            
            .main-content {
                max-height: none;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                height: auto;
                position: relative;
            }
            
            .assessment-table {
                font-size: 0.9rem;
                display: block;
                overflow-x: auto;
            }
            
            .assessment-table th, .assessment-table td {
                padding: 8px;
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="row g-0">
            <!-- Sidebar Navigation -->
            <div class="col-lg-2">
                <div class="sidebar">
                    <h4 class="text-center mb-4">HID SCT Assessment</h4>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#info" data-bs-toggle="tab">
                                <i class="fas fa-info-circle"></i> INFO
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#definition" data-bs-toggle="tab">
                                <i class="fas fa-book"></i> DEFINITION
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#org-detail" data-bs-toggle="tab">
                                <i class="fas fa-building"></i> ORGANIZATIONAL DETAIL
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#guiding-principles" data-bs-toggle="tab">
                                <i class="fas fa-star"></i> GUIDING PRINCIPLES
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#core-standards" data-bs-toggle="tab">
                                <i class="fas fa-cogs"></i> CORE STANDARDS
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#clinical-standards" data-bs-toggle="tab">
                                <i class="fas fa-stethoscope"></i> CLINICAL STANDARDS
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#logistic-standards" data-bs-toggle="tab">
                                <i class="fas fa-truck"></i> LOGISTIC STANDARDS
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#wash-standards" data-bs-toggle="tab">
                                <i class="fas fa-hand-holding-water"></i> WASH STANDARDS
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#summary" data-bs-toggle="tab">
                                <i class="fas fa-file-alt"></i> SUMMARY
                            </a>
                        </li>
                    </ul>
                    <div class="mt-4 p-3">
                        <div class="progress-bar-container">
                            <div class="progress-bar bg-success" id="overallProgressBar" style="width: 0%"></div>
                        </div>
                        <p class="mb-1">Overall Completion</p>
                        <h5 class="text-center" id="overallProgressText">0%</h5>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-lg-8">
                <div class="main-content">
                    <div class="tab-content">
                        <!-- INFO Tab -->
                        <div class="tab-pane fade show active" id="info">
                            <h2 class="mb-4">Self-Assessment Checklist for Emergency Medical Teams</h2>
                            <div class="card section-card">
                                <div class="card-body">
                                    <h5 class="card-title">Minimum Standards for Highly Infectious Disease (HID) Specialized Care Team (SCT) â€“ AWD Inpatient</h5>
                                    <p class="card-text">
                                        This self-assessment tool is designed to help HID SCTs evaluate their readiness and capabilities according to the established minimum standards.
                                    </p>
                                    <p class="card-text">
                                        Use this digital tool to complete your assessment, track progress, and generate reports for your organization and the coordination mechanism.
                                    </p>
                                    <p class="text-muted">Version 1.0/2025</p>
                                </div>
                            </div>
                            
                            <div class="row mt-4">
                                <div class="col-md-4">
                                    <div class="overview-card bg-light">
                                        <i class="fas fa-check-circle fa-2x text-success"></i>
                                        <h5>Completed Sections</h5>
                                        <div class="card-value" id="completedSections">0/8</div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="overview-card bg-light">
                                        <i class="fas fa-chart-line fa-2x text-primary"></i>
                                        <h5>Overall Score</h5>
                                        <div class="card-value" id="overallScore">0%</div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="overview-card bg-light">
                                        <i class="fas fa-clock fa-2x text-warning"></i>
                                        <h5>Last Updated</h5>
                                        <div class="card-value" id="lastUpdated">Today</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- DEFINITION Tab -->
                        <div class="tab-pane fade" id="definition">
                            <h2 class="mb-4">Technical Standards Definition</h2>
                            <div class="card section-card">
                                <div class="card-body">
                                    <p>
                                        HID SCTs are national or international teams deployed at the request of the Ministry of Health (MOH)/ coordination cell of the host country. 
                                        The HID SCT's modality of deployment (embed, coupled or self-sustained) depends on context and defined capacity/level of care.
                                    </p>
                                    <p>
                                        Depending on modality of deployment, some operations support, logistics and WASH elements may be provided by a host facility.
                                    </p>
                                    <p>
                                        The level of required support needs to be clarified prior to any deployment, and agreed by teams, receiving facilities and the coordination mechanism. 
                                        Teams must have SOPs in place that clearly state the minimum support requirements that need to be provided by the host facility in order to deploy. 
                                        Teams with greater operational independence have greater flexibility and are more likely to be requested to deploy.
                                    </p>
                                    <p>
                                        Regardless of the modality of deployment, teams need to ensure self-sufficiency and the ability to provide all the required equipment and consumables to deliver their services as defined by 
                                        "Minimum standards and recommendations for medical teams responding to highly infectious disease outbreaks" for the entire period of their deployment. 
                                        All teams opting for an embedded or coupled modality of deployment MUST communicate with the receiving facility to determine, 
                                        which specialist equipment or consumables might be available and to understand local procurement challenges. 
                                        Teams should always plan for contingencies and deploy with increased quantities of required equipment and consumables if resupply is likely to be challenging. 
                                        HID SCTs needs to declare their intended length of stay (including potential staff rotations) to the EMT coordination mechanism (EMTCC)/Ministry of Health in their Expression of Interest.
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ORGANIZATIONAL DETAIL Tab -->
                        <div class="tab-pane fade" id="org-detail">
                            <h2 class="mb-4">Organizational Details</h2>
                            
                            <div class="card section-card">
                                <div class="section-header">
                                    <h5>Team Information</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label for="teamName" class="form-label">Team Name</label>
                                            <input type="text" class="form-control" id="teamName">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="region" class="form-label">Region</label>
                                            <input type="text" class="form-control" id="region">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label for="country" class="form-label">Country</label>
                                            <input type="text" class="form-control" id="country">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="mentorName" class="form-label">Mentor Name</label>
                                            <input type="text" class="form-control" id="mentorName">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card section-card">
                                <div class="section-header">
                                    <h5>Contact Information</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <h6>Headquarters Contact</h6>
                                            <div class="mb-2">
                                                <label class="form-label">Name</label>
                                                <input type="text" class="form-control" id="hqName">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Email</label>
                                                <input type="email" class="form-control" id="hqEmail">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Phone</label>
                                                <input type="tel" class="form-control" id="hqPhone">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Position</label>
                                                <input type="text" class="form-control" id="hqPosition">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>Operations Contact</h6>
                                            <div class="mb-2">
                                                <label class="form-label">Name</label>
                                                <input type="text" class="form-control" id="opsName">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Email</label>
                                                <input type="email" class="form-control" id="opsEmail">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Phone</label>
                                                <input type="tel" class="form-control" id="opsPhone">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label">Position</label>
                                                <input type="text" class="form-control" id="opsPosition">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card section-card">
                                <div class="section-header">
                                    <h5>Progress Overview</h5>
                                </div>
                                <div class="card-body">
                                    <table class="table table-bordered">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Section</th>
                                                <th>Weight</th>
                                                <th>Status</th>
                                                <th>% Completed</th>
                                            </tr>
                                        </thead>
                                        <tbody id="progressTableBody">
                                            <!-- Progress rows will be dynamically populated -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- GUIDING PRINCIPLES Tab -->
                        <div class="tab-pane fade" id="guiding-principles">
                            <h2 class="mb-4">Guiding Principles</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>Guiding Principles Compliance</h5>
                                    <div class="score-display" id="guidingPrinciplesScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Safe Care - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="safe-care">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Equitable Care - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="equitable-care">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Ethical Care - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="ethical-care">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Accountable Response - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="accountable-response">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Appropriate Response - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="appropriate-response">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Coordinated Response - Written statement on behalf the organization</td>
                                            <td>
                                                <select class="form-select score-select" data-section="guiding-principles" data-item="coordinated-response">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="comments-section">
                                    <label for="guidingPrinciplesComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="guidingPrinciplesComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- CORE STANDARDS Tab -->
                        <div class="tab-pane fade" id="core-standards">
                            <h2 class="mb-4">Core Standards</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>Core Standards Compliance</h5>
                                    <div class="score-display" id="coreStandardsScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Administration & Organizational Management</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="admin-management">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Human Resources</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="human-resources">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Professional Licensing & Conduct</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="professional-licensing">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Training of Teams</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="training-teams">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Coordination of EMTs</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="coordination-emts">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Records and Reporting</td>
                                            <td>
                                                <select class="form-select score-select" data-section="core-standards" data-item="records-reporting">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="comments-section">
                                    <label for="coreStandardsComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="coreStandardsComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- CLINICAL STANDARDS Tab -->
                        <div class="tab-pane fade" id="clinical-standards">
                            <h2 class="mb-4">Clinical Standards</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>Clinical Standards Compliance</h5>
                                    <div class="score-display" id="clinicalStandardsScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Screening - SCTs/EMTs have established screening systems</td>
                                            <td>
                                                <select class="form-select score-select" data-section="clinical-standards" data-item="screening">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Triage - SCTs/EMTs have established triage systems</td>
                                            <td>
                                                <select class="form-select score-select" data-section="clinical-standards" data-item="triage">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Treatment - SCT/EMT provides a systematic treatment plan</td>
                                            <td>
                                                <select class="form-select score-select" data-section="clinical-standards" data-item="treatment">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Obstetric & Newborn Care</td>
                                            <td>
                                                <select class="form-select score-select" data-section="clinical-standards" data-item="obstetric-care">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="comments-section">
                                    <label for="clinicalStandardsComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="clinicalStandardsComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- LOGISTIC STANDARDS Tab -->
                        <div class="tab-pane fade" id="logistic-standards">
                            <h2 class="mb-4">Logistic Standards</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>Logistic Standards Compliance</h5>
                                    <div class="score-display" id="logisticStandardsScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Power and Fuel - SCTs/EMTs must ensure sufficient power supply</td>
                                            <td>
                                                <select class="form-select score-select" data-section="logistic-standards" data-item="power-fuel">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Communications - SCTs/EMTs must have communication capabilities</td>
                                            <td>
                                                <select class="form-select score-select" data-section="logistic-standards" data-item="communications">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Transportation & Fleet</td>
                                            <td>
                                                <select class="form-select score-select" data-section="logistic-standards" data-item="transportation">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Warehouse Management</td>
                                            <td>
                                                <select class="form-select score-select" data-section="logistic-standards" data-item="warehouse">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="comments-section">
                                    <label for="logisticStandardsComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="logisticStandardsComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- WASH STANDARDS Tab -->
                        <div class="tab-pane fade" id="wash-standards">
                            <h2 class="mb-4">WASH Standards</h2>
                            
                            <div class="card section-card">
                                <div class="section-header d-flex justify-content-between align-items-center">
                                    <h5>WASH Standards Compliance</h5>
                                    <div class="score-display" id="washStandardsScore">0% Complete</div>
                                </div>
                                
                                <table class="assessment-table">
                                    <thead>
                                        <tr>
                                            <th width="40%">Standard</th>
                                            <th width="10%">Score</th>
                                            <th width="20%">Evidence</th>
                                            <th width="15%">Gaps</th>
                                            <th width="15%">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Water Supply - SCTs/EMTs must ensure sufficient safe drinking water</td>
                                            <td>
                                                <select class="form-select score-select" data-section="wash-standards" data-item="water-supply">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Hygiene - SCTs/EMTs must ensure safe hygiene measures</td>
                                            <td>
                                                <select class="form-select score-select" data-section="wash-standards" data-item="hygiene">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Environmental Cleaning</td>
                                            <td>
                                                <select class="form-select score-select" data-section="wash-standards" data-item="cleaning">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>Healthcare Waste Management</td>
                                            <td>
                                                <select class="form-select score-select" data-section="wash-standards" data-item="waste-management">
                                                    <option value="">-</option>
                                                    <option value="0">0 - Not started</option>
                                                    <option value="1">1 - Initial</option>
                                                    <option value="2">2 - In progress</option>
                                                    <option value="3">3 - Completed</option>
                                                    <option value="NA">N/A</option>
                                                </select>
                                            </td>
                                            <td><textarea class="form-control evidence-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control gaps-input" rows="2"></textarea></td>
                                            <td><textarea class="form-control action-input" rows="2"></textarea></td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="comments-section">
                                    <label for="washStandardsComments" class="form-label">Mentor Comments & Observations</label>
                                    <textarea class="form-control" id="washStandardsComments" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- SUMMARY Tab -->
                        <div class="tab-pane fade" id="summary">
                            <h2 class="mb-4">Summary & Action Plan</h2>
                            
                            <div class="card section-card">
                                <div class="section-header">
                                    <h5>Overall Readiness Assessment</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="strengths" class="form-label"><strong>Strengths Identified:</strong></label>
                                        <textarea class="form-control summary-textarea" id="strengths" placeholder="List the top 3-5 strengths identified through the assessment..."></textarea>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="criticalGaps" class="form-label"><strong>Critical Gaps Requiring Immediate Action:</strong></label>
                                        <textarea class="form-control summary-textarea" id="criticalGaps" placeholder="List the critical gaps that need immediate attention..."></textarea>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><strong>Timeline for Addressing Gaps:</strong></label>
                                        <div class="mb-2">
                                            <label class="form-label">Immediate (0-1 month):</label>
                                            <textarea class="form-control summary-textarea" id="immediateActions" placeholder="Actions to be taken immediately..."></textarea>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Short-term (1-3 months):</label>
                                            <textarea class="form-control summary-textarea" id="shortTermActions" placeholder="Actions for the next 1-3 months..."></textarea>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Medium-term (3-6 months):</label>
                                            <textarea class="form-control summary-textarea" id="mediumTermActions" placeholder="Actions for 3-6 months..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label"><strong>Support Required:</strong></label>
                                        <div class="mb-2">
                                            <label class="form-label">Technical assistance needed:</label>
                                            <textarea class="form-control summary-textarea" id="technicalAssistance" placeholder="Describe technical support requirements..."></textarea>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Training requirements:</label>
                                            <textarea class="form-control summary-textarea" id="trainingRequirements" placeholder="List training needs..."></textarea>
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label">Resource requirements:</label>
                                            <textarea class="form-control summary-textarea" id="resourceRequirements" placeholder="Specify resource needs..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="nextSteps" class="form-label"><strong>Next Steps:</strong></label>
                                        <textarea class="form-control summary-textarea" id="nextSteps" placeholder="1. First priority action&#10;2. Second priority action&#10;3. Third priority action"></textarea>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="completionDate" class="form-label">Date of Completion:</label>
                                            <input type="date" class="form-control" id="completionDate">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="reviewedBy" class="form-label">Reviewed by:</label>
                                            <input type="text" class="form-control" id="reviewedBy" placeholder="Name and title">
                                        </div>
                                    </div>
                                    
                                    <div class="mt-3">
                                        <label for="mentorAssignment" class="form-label">Mentor Assignment (if applicable):</label>
                                        <input type="text" class="form-control" id="mentorAssignment" placeholder="Mentor name and contact">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-between mt-4">
                        <button class="btn btn-outline-secondary" id="btn-export-json">
                            <i class="fas fa-download me-2"></i>Export JSON
                        </button>
                        <div>
                            <button class="btn btn-outline-primary me-2" id="btn-save">
                                <i class="fas fa-save me-2"></i>Save Draft
                            </button>
                            <button class="btn btn-outline-info me-2" id="btn-export-excel">
                                <i class="fas fa-file-excel me-2"></i>Export to Excel
                            </button>
                            <button class="btn btn-success" id="btn-submit">
                                <i class="fas fa-check-circle me-2"></i>Submit Assessment
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Progress Sidebar -->
            <div class="col-lg-2">
                <div class="progress-sidebar">
                    <h5 class="mb-3">Progress Overview</h5>
                    <div class="progress-bar-container mb-3">
                        <div class="progress-bar bg-success" id="sidebarProgressBar" style="width: 0%"></div>
                    </div>
                    <p class="mb-1">Overall Completion</p>
                    <h5 class="text-center mb-4" id="sidebarProgressText">0%</h5>
                    
                    <table class="progress-sidebar-table">
                        <thead>
                            <tr>
                                <th>Section</th>
                                <th>Status</th>
                                <th>%</th>
                            </tr>
                        </thead>
                        <tbody id="progressSidebarBody">
                            <!-- Progress rows will be dynamically populated -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Data storage
        let assessmentData = {
            teamInfo: {},
            scores: {},
            evidence: {},
            gaps: {},
            actions: {},
            comments: {},
            summary: {}
        };

        // Initialize from localStorage if available
        function initializeData() {
            const saved = localStorage.getItem('hidSCTAssessment');
            if (saved) {
                assessmentData = JSON.parse(saved);
                loadSavedData();
            }
            updateProgress();
        }

        // Load saved data into form
        function loadSavedData() {
            // Load team info
            if (assessmentData.teamInfo) {
                Object.keys(assessmentData.teamInfo).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = assessmentData.teamInfo[key];
                    }
                });
            }

            // Load scores and related data
            document.querySelectorAll('.score-select').forEach(select => {
                const key = `${select.dataset.section}-${select.dataset.item}`;
                if (assessmentData.scores[key]) {
                    select.value = assessmentData.scores[key];
                    updateScoreBadge(select);
                }
                
                const row = select.closest('tr');
                if (row) {
                    const evidenceInput = row.querySelector('.evidence-input');
                    const gapsInput = row.querySelector('.gaps-input');
                    const actionInput = row.querySelector('.action-input');

                    if (evidenceInput && assessmentData.evidence[key]) {
                        evidenceInput.value = assessmentData.evidence[key];
                    }
                    if (gapsInput && assessmentData.gaps[key]) {
                        gapsInput.value = assessmentData.gaps[key];
                    }
                    if (actionInput && assessmentData.actions[key]) {
                        actionInput.value = assessmentData.actions[key];
                    }
                }
            });

            // Load comments
            if (assessmentData.comments) {
                Object.keys(assessmentData.comments).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = assessmentData.comments[key];
                    }
                });
            }

            // Load summary
            if (assessmentData.summary) {
                Object.keys(assessmentData.summary).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = assessmentData.summary[key];
                    }
                });
            }
        }

        // Save progress
        function saveProgress() {
            // Save team info
            assessmentData.teamInfo = {
                teamName: document.getElementById('teamName').value,
                region: document.getElementById('region').value,
                country: document.getElementById('country').value,
                mentorName: document.getElementById('mentorName').value,
                hqName: document.getElementById('hqName').value,
                hqEmail: document.getElementById('hqEmail').value,
                hqPhone: document.getElementById('hqPhone').value,
                hqPosition: document.getElementById('hqPosition').value,
                opsName: document.getElementById('opsName').value,
                opsEmail: document.getElementById('opsEmail').value,
                opsPhone: document.getElementById('opsPhone').value,
                opsPosition: document.getElementById('opsPosition').value
            };

            // Save scores and related data
            document.querySelectorAll('.score-select').forEach(select => {
                const key = `${select.dataset.section}-${select.dataset.item}`;
                const row = select.closest('tr');
                
                if (select.value) {
                    assessmentData.scores[key] = select.value;
                }

                const evidenceInput = row.querySelector('.evidence-input');
                const gapsInput = row.querySelector('.gaps-input');
                const actionInput = row.querySelector('.action-input');

                if (evidenceInput) {
                    assessmentData.evidence[key] = evidenceInput.value;
                }
                if (gapsInput) {
                    assessmentData.gaps[key] = gapsInput.value;
                }
                if (actionInput) {
                    assessmentData.actions[key] = actionInput.value;
                }
            });

            // Save comments
            assessmentData.comments = {
                guidingPrinciplesComments: document.getElementById('guidingPrinciplesComments').value,
                coreStandardsComments: document.getElementById('coreStandardsComments').value,
                clinicalStandardsComments: document.getElementById('clinicalStandardsComments').value,
                logisticStandardsComments: document.getElementById('logisticStandardsComments').value,
                washStandardsComments: document.getElementById('washStandardsComments').value
            };

            // Save summary
            assessmentData.summary = {
                strengths: document.getElementById('strengths').value,
                criticalGaps: document.getElementById('criticalGaps').value,
                immediateActions: document.getElementById('immediateActions').value,
                shortTermActions: document.getElementById('shortTermActions').value,
                mediumTermActions: document.getElementById('mediumTermActions').value,
                technicalAssistance: document.getElementById('technicalAssistance').value,
                trainingRequirements: document.getElementById('trainingRequirements').value,
                resourceRequirements: document.getElementById('resourceRequirements').value,
                nextSteps: document.getElementById('nextSteps').value,
                completionDate: document.getElementById('completionDate').value,
                reviewedBy: document.getElementById('reviewedBy').value,
                mentorAssignment: document.getElementById('mentorAssignment').value
            };

            localStorage.setItem('hidSCTAssessment', JSON.stringify(assessmentData));
            
            showNotification('Progress saved successfully!');
            updateProgress();
        }

        // Show notification
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Update score badge
        function updateScoreBadge(select) {
            const value = select.value;
            select.className = 'form-select score-select';
            if (value !== '' && value !== 'NA') {
                select.classList.add(`score-${value}`);
            }
        }

        // Calculate scores and update progress
        function updateProgress() {
            let totalItems = 0;
            let scoredItems = 0;
            let totalScore = 0;
            let maxPossibleScore = 0;
            
            const sectionProgress = {
                'guiding-principles': { total: 0, completed: 0, score: 0, maxScore: 0 },
                'core-standards': { total: 0, completed: 0, score: 0, maxScore: 0 },
                'clinical-standards': { total: 0, completed: 0, score: 0, maxScore: 0 },
                'logistic-standards': { total: 0, completed: 0, score: 0, maxScore: 0 },
                'wash-standards': { total: 0, completed: 0, score: 0, maxScore: 0 }
            };

            document.querySelectorAll('.score-select').forEach(select => {
                const section = select.dataset.section;
                if (sectionProgress[section]) {
                    sectionProgress[section].total++;
                    totalItems++;
                    
                    if (select.value && select.value !== '') {
                        sectionProgress[section].completed++;
                        scoredItems++;
                        
                        if (select.value !== 'NA') {
                            const score = parseInt(select.value);
                            sectionProgress[section].score += score;
                            sectionProgress[section].maxScore += 3;
                            totalScore += score;
                            maxPossibleScore += 3;
                        }
                    }
                }
            });

            // Update section scores based on actual progress
            Object.keys(sectionProgress).forEach(section => {
                const progress = sectionProgress[section];
                let percentage = 0;
                
                if (progress.maxScore > 0) {
                    percentage = Math.round((progress.score / progress.maxScore) * 100);
                }
                
                const scoreElement = document.getElementById(`${section}Score`);
                if (scoreElement) {
                    scoreElement.textContent = `${percentage}% Complete`;
                }
            });

            // Update overall progress
            const overallProgress = maxPossibleScore > 0 ? Math.round((totalScore / maxPossibleScore) * 100) : 0;
            
            document.getElementById('overallProgressBar').style.width = `${overallProgress}%`;
            document.getElementById('overallProgressText').textContent = `${overallProgress}%`;
            document.getElementById('sidebarProgressBar').style.width = `${overallProgress}%`;
            document.getElementById('sidebarProgressText').textContent = `${overallProgress}%`;
            
            document.getElementById('completedSections').textContent = `${Object.values(sectionProgress).filter(s => s.completed > 0).length}/5`;
            document.getElementById('overallScore').textContent = `${overallProgress}%`;
            document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString();

            // Update progress table
            const progressTableBody = document.getElementById('progressTableBody');
            progressTableBody.innerHTML = '';
            
            const sections = [
                { name: 'GUIDING PRINCIPLES', weight: 2, section: 'guiding-principles' },
                { name: 'CORE STANDARDS', weight: 18, section: 'core-standards' },
                { name: 'CLINICAL STANDARDS', weight: 20, section: 'clinical-standards' },
                { name: 'LOGISTIC STANDARDS', weight: 10, section: 'logistic-standards' },
                { name: 'WASH STANDARDS', weight: 10, section: 'wash-standards' }
            ];
            
            let totalWeight = 0;
            let totalCompleted = 0;
            
            sections.forEach(s => {
                const progress = sectionProgress[s.section];
                let completed = 0;
                
                if (progress.maxScore > 0) {
                    completed = Math.round((progress.score / progress.maxScore) * 100);
                }
                
                const weight = s.weight;
                const completedWeight = Math.round(weight * (completed / 100));
                
                totalWeight += weight;
                totalCompleted += completedWeight;
                
                const status = completed === 0 ? 'Not Started' : 
                              completed < 100 ? 'In Progress' : 'Completed';
                const badgeClass = status === 'Completed' ? 'bg-success' : 
                                 status === 'In Progress' ? 'bg-warning' : 'bg-secondary';
                
                progressTableBody.innerHTML += `
                    <tr>
                        <td>${s.name}</td>
                        <td>${weight}%</td>
                        <td><span class="badge ${badgeClass}">${status}</span></td>
                        <td>${completed}%</td>
                    </tr>
                `;
            });
            
            const overallCompleted = totalWeight > 0 ? Math.round((totalCompleted / totalWeight) * 100) : 0;
            progressTableBody.innerHTML += `
                <tr class="table-primary fw-bold">
                    <td>TOTAL</td>
                    <td>${totalWeight}%</td>
                    <td></td>
                    <td>${overallCompleted}%</td>
                </tr>
            `;
            
            // Update progress sidebar
            const progressSidebarBody = document.getElementById('progressSidebarBody');
            progressSidebarBody.innerHTML = '';
            
            sections.forEach(s => {
                const progress = sectionProgress[s.section];
                let completed = 0;
                
                if (progress.maxScore > 0) {
                    completed = Math.round((progress.score / progress.maxScore) * 100);
                }
                
                const status = completed === 0 ? 'Not Started' : 
                              completed < 100 ? 'In Progress' : 'Completed';
                const badgeClass = status === 'Completed' ? 'bg-success' : 
                                 status === 'In Progress' ? 'bg-warning' : 'bg-secondary';
                
                progressSidebarBody.innerHTML += `
                    <tr>
                        <td>${s.name.split(' ')[0]}</td>
                        <td><span class="badge ${badgeClass}">${status}</span></td>
                        <td>${completed}%</td>
                    </tr>
                `;
            });
        }

        // Export to Excel
        function exportToExcel() {
            saveProgress();
            
            // Prepare data for Excel export
            const data = [];
            
            // Add headers
            data.push(['Standard ID', 'Pillar', 'Standard Statement', 'Score', 'Evidence', 'Gaps', 'Actions', 'Comments']);
            
            // Add assessment items
            document.querySelectorAll('.score-select').forEach(select => {
                const row = select.closest('tr');
                const standardCell = row.cells[0];
                const section = select.dataset.section;
                const key = `${select.dataset.section}-${select.dataset.item}`;
                
                const pillar = section === 'guiding-principles' ? 'Guiding Principles' :
                              section === 'core-standards' ? 'Core Standards' :
                              section === 'clinical-standards' ? 'Clinical Standards' :
                              section === 'logistic-standards' ? 'Logistic Standards' :
                              section === 'wash-standards' ? 'WASH Standards' : 'Other';
                
                const evidenceInput = row.querySelector('.evidence-input');
                const gapsInput = row.querySelector('.gaps-input');
                const actionInput = row.querySelector('.action-input');
                
                data.push([
                    key,
                    pillar,
                    standardCell.textContent,
                    select.value || '',
                    evidenceInput ? evidenceInput.value : '',
                    gapsInput ? gapsInput.value : '',
                    actionInput ? actionInput.value : '',
                    assessmentData.comments[`${section}Comments`] || ''
                ]);
            });
            
            // Create workbook and worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // Add worksheet to workbook
            XLSX.utils.book_append_sheet(wb, ws, 'HID SCT Assessment');
            
            // Add summary sheet
            const summaryData = [
                ['Summary Section', 'Content'],
                ['Strengths Identified', assessmentData.summary.strengths || ''],
                ['Critical Gaps', assessmentData.summary.criticalGaps || ''],
                ['Immediate Actions (0-1 month)', assessmentData.summary.immediateActions || ''],
                ['Short-term Actions (1-3 months)', assessmentData.summary.shortTermActions || ''],
                ['Medium-term Actions (3-6 months)', assessmentData.summary.mediumTermActions || ''],
                ['Technical Assistance Needed', assessmentData.summary.technicalAssistance || ''],
                ['Training Requirements', assessmentData.summary.trainingRequirements || ''],
                ['Resource Requirements', assessmentData.summary.resourceRequirements || ''],
                ['Next Steps', assessmentData.summary.nextSteps || ''],
                ['Completion Date', assessmentData.summary.completionDate || ''],
                ['Reviewed By', assessmentData.summary.reviewedBy || ''],
                ['Mentor Assignment', assessmentData.summary.mentorAssignment || '']
            ];
            
            const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, summaryWs, 'Summary');
            
            // Export the workbook
            XLSX.writeFile(wb, `HID_SCT_Assessment_${new Date().toISOString().split('T')[0]}.xlsx`);
            showNotification('Data exported to Excel successfully!');
        }

        // Export to JSON
        function exportToJSON() {
            saveProgress();
            
            const dataStr = JSON.stringify(assessmentData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `HID_SCT_Assessment_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showNotification('Data exported to JSON successfully!');
        }

        // Initialize event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize data
            initializeData();
            
            // Add change listeners for scores
            document.querySelectorAll('.score-select').forEach(select => {
                select.addEventListener('change', function() {
                    updateScoreBadge(this);
                    saveProgress();
                });
            });
            
            // Add input listeners for text fields
            document.querySelectorAll('input, textarea, select').forEach(element => {
                element.addEventListener('change', function() {
                    saveProgress();
                });
            });
            
            // Set today's date as default for assessment date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('completionDate').value = today;
            
            // Add event listeners for buttons
            document.getElementById('btn-save').addEventListener('click', saveProgress);
            document.getElementById('btn-export-json').addEventListener('click', exportToJSON);
            document.getElementById('btn-export-excel').addEventListener('click', exportToExcel);
            document.getElementById('btn-submit').addEventListener('click', function() {
                saveProgress();
                showNotification('Assessment submitted successfully!');
            });
            
            // Initialize tab functionality
            const triggerTabList = document.querySelectorAll('.nav-link');
            triggerTabList.forEach(triggerEl => {
                triggerEl.addEventListener('click', function (event) {
                    event.preventDefault();
                    const target = this.getAttribute('href');
                    
                    // Update active tab
                    triggerTabList.forEach(tab => {
                        tab.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Show target tab content
                    document.querySelectorAll('.tab-pane').forEach(pane => {
                        pane.classList.remove('show', 'active');
                    });
                    document.querySelector(target).classList.add('show', 'active');
                });
            });
        });
    </script>
</body>
</html>
